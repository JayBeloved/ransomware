{% extends 'base.html' %}

{% block title %}Classify{% endblock %}

{% block content %}
<h2>Classify Ransomware</h2>
<form method="post">
    {% csrf_token %}
    <div class="row">
        <div class="col-md-4">
            <div class="mb-2">
                <label for="machine" class="form-label">Machine</label>
                <input type="number" class="form-control" id="machine" name="machine">
            </div>
            <div class="mb-2">
                <label for="debug_size" class="form-label">Debug Size</label>
                <input type="number" class="form-control" id="debug_size" name="debug_size">
            </div>
            <div class="mb-2">
                <label for="debug_rva" class="form-label">Debug RVA</label>
                <input type="number" class="form-control" id="debug_rva" name="debug_rva">
            </div>
            <div class="mb-2">
                <label for="major_image_version" class="form-label">Major Image Version</label>
                <input type="number" class="form-control" id="major_image_version" name="major_image_version">
            </div>
            <div class="mb-2">
                <label for="major_os_version" class="form-label">Major OS Version</label>
                <input type="number" class="form-control" id="major_os_version" name="major_os_version">
            </div>
        </div>
        <div class="col-md-4">
            <div class="mb-2">
                <label for="export_rva" class="form-label">Export RVA</label>
                <input type="number" class="form-control" id="export_rva" name="export_rva">
            </div>
            <div class="mb-2">
                <label for="export_size" class="form-label">Export Size</label>
                <input type="number" class="form-control" id="export_size" name="export_size">
            </div>
            <div class="mb-2">
                <label for="iat_vra" class="form-label">Iat VRA</label>
                <input type="number" class="form-control" id="iat_vra" name="iat_vra">
            </div>
            <div class="mb-2">
                <label for="major_linker_version" class="form-label">Major Linker Version</label>
                <input type="text" class="form-control" id="major_linker_version" name="major_linker_version">
            </div>
            <div class="mb-2">
                <label for="minor_linker_version" class="form-label">Minor Linker Version</label>
                <input type="text" class="form-control" id="minor_linker_version" name="minor_linker_version">
            </div>
        </div>
        <div class="col-md-4">
            <div class="mb-2">
                <label for="number_of_sections" class="form-label">Number Of Sections</label>
                <input type="text" class="form-control" id="number_of_sections" name="number_of_sections">
            </div>
            <div class="mb-2">
                <label for="size_of_stack_reserve" class="form-label">Size Of Stack Reserve</label>
                <input type="text" class="form-control" id="size_of_stack_reserve" name="size_of_stack_reserve">
            </div>
            <div class="mb-2">
                <label for="dll_characteristics" class="form-label">Dll Characteristics</label>
                <input type="text" class="form-control" id="dll_characteristics" name="dll_characteristics">
            </div>
            <div class="mb-2">
                <label for="resource_size" class="form-label">Resource Size</label>
                <input type="text" class="form-control" id="resource_size" name="resource_size">
            </div>
            <div class="mb-2">
                <label for="bitcoin_addresses" class="form-label">Bitcoin Addresses</label>
                <input type="text" class="form-control" id="bitcoin_addresses" name="bitcoin_addresses">
            </div>
        </div>
    </div>
    <div class="mb-2">
        <label for="model_type" class="form-label">Model Type</label>
        <select class="form-select" id="model_type" name="model_type">
            <option value="rf">Random Forest</option>
            <option value="nb">Naive Bayes</option>
        </select>
    </div>
    <div class="row">
        <div class="col-md-6">
            <button type="submit" class="btn btn-primary w-100">Submit</button>
        </div>
        <div class="col-md-6">
            <button type="button" class="btn btn-secondary w-100" onclick="fillDefaultData()">Use Default Data</button>
        </div>
    </div>
</form>

<script>
    function fillDefaultData() {
        const defaultData = [
            {
                machine: 332,
                debug_size: 0,
                debug_rva: 0,
                major_image_version: 0,
                major_os_version: 4,
                export_rva: 0,
                export_size: 0,
                iat_vra: 8192,
                major_linker_version: 8,
                minor_linker_version: 0,
                number_of_sections: 3,
                size_of_stack_reserve: 1048576,
                dll_characteristics: 34112,
                resource_size: 672,
                bitcoin_addresses: 0
            },
            {
                machine: 34404,
                debug_size: 84,
                debug_rva: 24608,
                major_image_version: 10,
                major_os_version: 10,
                export_rva: 30816,
                export_size: 328,
                iat_vra: 22680,
                major_linker_version: 14,
                minor_linker_version: 10,
                number_of_sections: 7,
                size_of_stack_reserve: 262144,
                dll_characteristics: 16736,
                resource_size: 1072,
                bitcoin_addresses: 0
            },
            {
                machine: 322,
                debug_size: 84,
                debug_rva: 119964,
                major_image_version: 0,
                major_os_version: 6,
                export_rva: 143360,
                export_size: 147,
                iat_vra: 122880,
                major_linker_version: 14,
                minor_linker_version: 10,
                number_of_sections: 6,
                size_of_stack_reserve: 1048576,
                dll_characteristics: 320,
                resource_size: 2032,
                bitcoin_addresses: 0
            },
            {
                machine: 322,
                debug_size: 0,
                debug_rva: 0,
                major_image_version: 0,
                major_os_version: 4,
                export_rva: 24336,
                export_size: 74,
                iat_vra: 4096,
                major_linker_version: 7,
                minor_linker_version: 0,
                number_of_sections: 3,
                size_of_stack_reserve: 1048576,
                dll_characteristics: 0,
                resource_size: 64088,
                bitcoin_addresses: 0
            },
            {
                machine: 344,
                debug_size: 1,
                debug_rva: 1,
                major_image_version: 1,
                major_os_version: 5,
                export_rva: 1,
                export_size: 1,
                iat_vra: 8192,
                major_linker_version: 7,
                minor_linker_version: 1,
                number_of_sections: 4,
                size_of_stack_reserve: 2097152,
                dll_characteristics: 1,
                resource_size: 1,
                bitcoin_addresses: 1
            },
            {
                machine: 332,
                debug_size: 0,
                debug_rva: 0,
                major_image_version: 0,
                major_os_version: 5,
                export_rva: 0,
                export_size: 0,
                iat_vra: 532480,
                major_linker_version: 10,
                minor_linker_version: 0,
                number_of_sections: 4,
                size_of_stack_reserve: 4194304,
                dll_characteristics: 32768,
                resource_size: 32152,
                bitcoin_addresses: 0
            },
            {
                machine: 332,
                debug_size: 28,
                debug_rva: 21424,
                major_image_version: 0,
                major_os_version: 4,
                export_rva: 0,
                export_size: 0,
                iat_vra: 8192,
                major_linker_version: 11,
                minor_linker_version: 0,
                number_of_sections: 3,
                size_of_stack_reserve: 1048576,
                dll_characteristics: 34112,
                resource_size: 6288,
                bitcoin_addresses: 0
            }
        ];

        const randomData = defaultData[Math.floor(Math.random() * defaultData.length)];

        document.getElementById('machine').value = randomData.machine;
        document.getElementById('debug_size').value = randomData.debug_size;
        document.getElementById('debug_rva').value = randomData.debug_rva;
        document.getElementById('major_image_version').value = randomData.major_image_version;
        document.getElementById('major_os_version').value = randomData.major_os_version;
        document.getElementById('export_rva').value = randomData.export_rva;
        document.getElementById('export_size').value = randomData.export_size;
        document.getElementById('iat_vra').value = randomData.iat_vra;
        document.getElementById('major_linker_version').value = randomData.major_linker_version;
        document.getElementById('minor_linker_version').value = randomData.minor_linker_version;
        document.getElementById('number_of_sections').value = randomData.number_of_sections;
        document.getElementById('size_of_stack_reserve').value = randomData.size_of_stack_reserve;
        document.getElementById('dll_characteristics').value = randomData.dll_characteristics;
        document.getElementById('resource_size').value = randomData.resource_size;
        document.getElementById('bitcoin_addresses').value = randomData.bitcoin_addresses;
    }
</script>
{% endblock %}